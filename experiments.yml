experiments:
  - name: random-averaged
    args: ['./build/robustness', '-a0', '-i', '@INSTANCE@', '@EXTRA_ARGS@', ]
    stdout: out
  - name: submodular-greedy
    args: ['./build/robustness', '-a1', '-i', '@INSTANCE@', '@EXTRA_ARGS@', ]
    stdout: out
  - name: stochastic-greedy
    args: ['./build/robustness', '-a2', '-i', '@INSTANCE@', '@EXTRA_ARGS@', ]
    stdout: out
  - name: stochastic-greedy-lu
    args: ['./build/robustness', '-a3', '--lu', '-i', '@INSTANCE@', '@EXTRA_ARGS@']
    stdout: out
  - name: greedy-3
    args: ['./build/robustness', '-a5', '-i', '@INSTANCE@', '@EXTRA_ARGS@', ]
    stdout: out
  - name: sq-greedy
    args: ['./build/robustness', '-a6', '-i', '@INSTANCE@', '@EXTRA_ARGS@', '-tr', '-v']
    stdout: out
    #slurm_args: ['--partition=single', '--nodelist=ego']
  - name: test-jlt
    args: ['./build/robustness', '--test-jlt', '-i', '@INSTANCE@', '@EXTRA_ARGS@', ]
    stdout: out
    slurm_args: ['--partition=single', '--nodelist=ego']

variants:
  - axis: 'k-size-linear'
    items:
      - name: '2**-4'
        extra_args: ['-km', 'linear', '--k-factor', '0.0625']
      - name: '2**-2'
        extra_args: ['-km', 'linear', '--k-factor', '0.25']
      - name: '2**0'
        extra_args: ['-km', 'linear', '--k-factor', '1.0']
      - name: '2**2'
        extra_args: ['-km', 'linear', '--k-factor', '4.0']
  - axis: 'k-size-const'
    items:
      - name: 'k-2'
        extra_args: ['--k-factor', '2']
      - name: 'k-5'
        extra_args: ['--k-factor', '5']
      - name: 'k-20'
        extra_args: ['--k-factor', '20']
      - name: 'k-50'
        extra_args: ['--k-factor', '50']
      - name: 'k-200'
        extra_args: ['--k-factor', '200']
  - axis: 'threads'
    items:
      #- name: 'singlecore'
      #  extra_args: ['-j', '1']
      - name: 'multicore'
        extra_args: ['-j', '12']
        num_threads: 12
  - axis: 'accuracy'
    items:
      - name: 'eps_0.1'
        extra_args: ['-eps', '0.1']
      - name: 'eps_0.9'
        extra_args: ['-eps', '0.9']
      - name: 'eps_0.99'
        extra_args: ['-eps', '0.99']
  - axis: 'accuracy_trees'
    items:
#      - name: 'eps2_1.0'
#        extra_args: ['-eps2', '1.0']
      - name: 'eps2_10'
        extra_args: ['-eps2', '10']
  - axis: 'all_columns'
    items:
      - name: 'all_columns'
        extra_args: ['--all_columns']
  - axis: 'linalg'
    items:
#      - name: 'dense-ldlt'
#        extra_args: ['--dense-ldlt']
      - name: 'lamg'
        extra_args: ['--lamg']
      - name: 'lu'
        extra_args: ['--lu']
      - name: 'jlt-lu'
        extra_args: ['--jlt-lu']
      - name: 'jlt-lamg'
        extra_args: ['--jlt-lamg']
#      - name: 'qr'
#        extra_args: ['--qr']
  - axis: 'heuristic'
    items:
      - name: 'random'
        extra_args: ['-h0']
      - name: 'ust-diag'
        extra_args: ['-h1']
      - name: 'similarity'
        extra_args: ['-h2']


        
instdir: "instances"
instances:
  - repo: local
    items: 
      - facebook_ego_combined.nkb
      - arxiv-grqc.nkb
      - arxiv-heph.nkb
      - arxiv-hephth.nkb
      - arxiv-astro-ph.nkb
      - arxiv-condmat.nkb
      - opsahl-powergrid.nkb
      - deezer_europe.nkb
      - inf-power.nkb
      - inf-openflights.nkb
      - ia-email-EU.nkb
    set: [large-graphs]


  - repo: local
    items:
      - erdos_renyi_10000_0.01_0.nkb
      - watts_strogatz_10000_20_0.2_0.nkb
      - barabasi_albert_5_10000_3_0.nkb
      - erdos_renyi_10000_0.01.nkb
      - watts_strogatz_10000_20_0.2.nkb
      - barabasi_albert_5_10000_3.nkb
      - erdos_renyi_10000_0.01_2.nkb
      - watts_strogatz_10000_20_0.2_2.nkb
      - barabasi_albert_5_10000_3_2.nkb
      - erdos_renyi_10000_0.01_3.nkb
      - watts_strogatz_10000_20_0.2_3.nkb
      - barabasi_albert_5_10000_3_3.nkb
      - erdos_renyi_10000_0.01_4.nkb
      - watts_strogatz_10000_20_0.2_4.nkb
      - barabasi_albert_5_10000_3_4.nkb
      - erdos_renyi_10000_0.01_5.nkb
      - watts_strogatz_10000_20_0.2_5.nkb
      - barabasi_albert_5_10000_3_5.nkb
      - erdos_renyi_10000_0.01_6.nkb
      - watts_strogatz_10000_20_0.2_6.nkb
      - barabasi_albert_5_10000_3_6.nkb
      - erdos_renyi_10000_0.01_7.nkb
      - watts_strogatz_10000_20_0.2_7.nkb
      - barabasi_albert_5_10000_3_7.nkb
      - erdos_renyi_10000_0.01_8.nkb
      - watts_strogatz_10000_20_0.2_8.nkb
      - barabasi_albert_5_10000_3_8.nkb
      - erdos_renyi_10000_0.01_9.nkb
      - watts_strogatz_10000_20_0.2_9.nkb
      - barabasi_albert_5_10000_3_9.nkb
      - erdos_renyi_10000_0.01_10.nkb
      - watts_strogatz_10000_20_0.2_10.nkb
      - barabasi_albert_5_10000_3_10.nkb
      - erdos_renyi_10000_0.01_11.nkb
      - watts_strogatz_10000_20_0.2_11.nkb
      - barabasi_albert_5_10000_3_11.nkb
      - erdos_renyi_10000_0.01_12.nkb
      - watts_strogatz_10000_20_0.2_12.nkb
      - barabasi_albert_5_10000_3_12.nkb
      - erdos_renyi_10000_0.01_13.nkb
      - watts_strogatz_10000_20_0.2_13.nkb
      - barabasi_albert_5_10000_3_13.nkb
      - erdos_renyi_10000_0.01_14.nkb
      - watts_strogatz_10000_20_0.2_14.nkb
      - barabasi_albert_5_10000_3_14.nkb
      - erdos_renyi_10000_0.01_15.nkb
      - watts_strogatz_10000_20_0.2_15.nkb
      - barabasi_albert_5_10000_3_15.nkb
      - erdos_renyi_10000_0.01_16.nkb
      - watts_strogatz_10000_20_0.2_16.nkb
      - barabasi_albert_5_10000_3_16.nkb
      - erdos_renyi_10000_0.01_17.nkb
      - watts_strogatz_10000_20_0.2_17.nkb
      - barabasi_albert_5_10000_3_17.nkb
      - erdos_renyi_10000_0.01_18.nkb
      - watts_strogatz_10000_20_0.2_18.nkb
      - barabasi_albert_5_10000_3_18.nkb
      - erdos_renyi_10000_0.01_19.nkb
      - watts_strogatz_10000_20_0.2_19.nkb
      - barabasi_albert_5_10000_3_19.nkb
    set: [large-graphs-generated]


  - repo: local
    items:
      - erdos_renyi_128_0.1.nkb
      - erdos_renyi_300_0.05.nkb
      - erdos_renyi_600_0.05.nkb
      - watts_strogatz_100_5_0.5.nkb
      - watts_strogatz_300_7_0.5.nkb
      - barabasi_albert_2_100_2.nkb
      - barabasi_albert_2_300_2.nkb


  - repo: local
    items:
      - erdos_renyi_1000_0.02.nkb
      - erdos_renyi_3000_0.01.nkb
      - watts_strogatz_1000_7_0.3.nkb
      - watts_strogatz_3000_7_0.3.nkb
      - barabasi_albert_2_1000_2.nkb
      - barabasi_albert_2_3000_2.nkb
    set: [medium-graphs]
  - repo: local
    items:
      - loc-brightkite.nkb
      - flickr.nkb
      - livemocha.nkb
      - road-usroads.nkb
      - road-luxembourg-osm.nkb
        #- ia-email-EU-dir.nkb
        #- ca-dblp-2010.nkb
    set: [huge-graphs]




matrix:
  include:
      # Small Graphs
    #- experiments: [submodular-greedy]
    #  instsets: [medium-graphs]
    #  axes: ['k-size-linear', threads]
    #- experiments: [stochastic-greedy, greedy-3]
    #  instsets: [medium-graphs]
    #  axes: ['k-size-linear', threads, 'accuracy']
    #- experiments: [sq-greedy]
    #  instsets: [medium-graphs]
    #  axes: ['k-size-linear', 'threads', 'accuracy', 'linalg', 'accuracy_trees', 'heuristic']
    #  variants: ['ust-diag', 'eps_0.9', 'lu', 'lamg', ]

      # Comparison Algorithms
    - experiments: ['submodular-greedy']
      instsets: ['large-graphs']
      axes: ['k-size-const', 'threads']
    - experiments: ['stochastic-greedy']
      instsets: ['large-graphs']
      axes: ['k-size-const', 'threads', 'accuracy']
      variants: ['eps_0.9']

      # Main Algorithm
    - experiments: ['sq-greedy']
      instsets: ['large-graphs']
      axes: ['k-size-const', 'threads', 'accuracy', 'linalg', 'accuracy_trees', 'heuristic']
      variants: ['ust-diag', 'eps_0.9', 'lu', 'multicore']
    - experiments: ['sq-greedy']
      instsets: ['large-graphs']
      axes: ['k-size-const', 'threads', 'accuracy', 'linalg', 'heuristic']
      variants: ['similarity', 'random', 'eps_0.9', 'lu', 'multicore']

      # JLT
    - experiments: ['test-jlt']
      axes: ['threads', 'k-size-const']
      variants: ['multicore']
      instsets: ['large-graphs']

      # JLT for similarity
    - experiments: ['sq-greedy']
      instsets: ['large-graphs']
      axes: ['k-size-const', 'threads', 'linalg', 'accuracy', 'heuristic']
      variants: ['similarity', 'eps_0.9', 'jlt-lu', 'multicore', ]
      # JLT for random
    - experiments: ['sq-greedy']
      instsets: ['large-graphs']
      axes: ['k-size-const', 'threads', 'linalg', 'accuracy', 'heuristic']
      variants: ['similarity', 'eps_0.9', 'jlt-lu', 'multicore', ]
      # JLT for diagonal
    - experiments: ['sq-greedy']
      instsets: ['large-graphs']
      axes: ['k-size-const', 'threads', 'linalg', 'accuracy', 'accuracy_trees', 'heuristic']
      variants: ['ust-diag', 'eps_0.9', 'jlt-lu', 'multicore', 'eps2_10' ]
      # Lamg
    - experiments: ['sq-greedy']
      instsets: ['large-graphs']
      axes: ['k-size-const', 'threads', 'linalg', 'accuracy', 'heuristic']
      variants: ['k-2', 'k-5', 'k-20', 'similarity', 'eps_0.9', 'eps2_10', 'lamg', 'multicore', ]      
      # JLT-Lamg for similarity
    - experiments: ['sq-greedy']
      instsets: ['large-graphs']
      axes: ['k-size-const', 'threads', 'linalg', 'accuracy', 'heuristic']
      variants: ['similarity', 'eps_0.9', 'jlt-lamg', 'multicore', ]


      # Generated instances
    - experiments: ['sq-greedy']
      instsets: ['large-graphs-generated']
      axes: ['k-size-const', 'threads', 'accuracy', 'linalg', 'heuristic']
      variants: ['similarity', 'random', 'eps_0.9', 'lu', 'multicore', 'eps2_10']
      # JLT for similarity
    - experiments: ['sq-greedy']
      instsets: ['large-graphs-generated']
      axes: ['k-size-const', 'threads', 'linalg', 'accuracy', 'heuristic']
      variants: ['k-2', 'k-5', 'k-20', 'similarity', 'eps_0.9', 'jlt-lu', 'multicore', 'eps2_10']
    - experiments: ['sq-greedy']
      instsets: ['large-graphs-generated']
      axes: ['k-size-const', 'threads', 'linalg', 'accuracy', 'heuristic', 'all_columns']
      variants: ['k-2', 'k-5', 'k-20', 'similarity', 'eps_0.9', 'lu', 'multicore', 'all_columns', 'eps2_10' ]
      
      # Huge Instances
    - experiments: ['sq-greedy']
      instsets: ['huge-graphs']
      axes: ['k-size-const', 'threads', 'linalg', 'accuracy', 'heuristic']
      variants: ['k-2', 'k-5', 'k-20', 'eps_0.9', 'jlt-lamg', 'multicore', 'random', 'similarity']
    - experiments: ['sq-greedy']
      instsets: ['huge-graphs']
      axes: ['k-size-const', 'threads', 'linalg', 'accuracy', 'heuristic']
      variants: ['k-2', 'k-5', 'k-20', 'eps_0.9', 'eps_0.99', 'lamg', 'multicore', 'random', 'similarity']
