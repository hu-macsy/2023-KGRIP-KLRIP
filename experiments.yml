experiments:
  - name: submodular-greedy
    args: ['./build/robustness', '-a1', '-i', '@INSTANCE@', '@EXTRA_ARGS@', ]
    stdout: out
  - name: stochastic-greedy
    args: ['./build/robustness', '-a2', '-i', '@INSTANCE@', '@EXTRA_ARGS@', ]
    stdout: out
  - name: random-averaged
    args: ['./build/robustness', '-a0', '-i', '@INSTANCE@', '@EXTRA_ARGS@', ]
    stdout: out
  - name: greedy-3
    args: ['./build/robustness', '-a5', '-i', '@INSTANCE@', '@EXTRA_ARGS@', ]
    stdout: out
  - name: sq-greedy
    args: ['./build/robustness', '-a6', '-i', '@INSTANCE@', '@EXTRA_ARGS@', ]
    stdout: out

variants:
  - axis: 'k-size-linear'
    items:
      # - name: 'crt'
      #   extra_args: ['-km', 'crt', '--k-factor', '3.0']
      # - name: 'sqrt'
      #   extra_args: ['-km', 'sqrt', '--k-factor', '3.0']
      #- name: '2**-7'
      #  extra_args: ['-km', 'linear', '--k-factor', '0.0078125']
      #- name: '2**-5'
      #  extra_args: ['-km', 'linear', '--k-factor', '0.03125']
      - name: '2**-4'
        extra_args: ['-km', 'linear', '--k-factor', '0.0625']
      - name: '2**-2'
        extra_args: ['-km', 'linear', '--k-factor', '0.25']
      - name: '2**0'
        extra_args: ['-km', 'linear', '--k-factor', '1.0']
      - name: '2**2'
        extra_args: ['-km', 'linear', '--k-factor', '4.0']
      - name: 2**4
        extra_args: ['-km', 'linear', '--k-factor', '16.0']
  - axis: 'k-size-const'
    items:
      - name: 'k-50'      
        extra_args: ['--k-factor 50']
      - name: 'k-300'
        extra_args: ['--k-factor 300']
  - axis: 'threads'
    items:
      - name: 'singlecore'
        extra_args: ['-j', '1']
      - name: 'multicore'
        extra_args: ['-j', '12']
  - axis: 'accuracy'
    items:
      - name: 'eps_0.1'
        extra_args: ['-eps', '0.1']
      - name: 'eps_0.9'
        extra_args: ['-eps', '0.9']
  - axis: 'accuracy_trees'
    items:
      - name: 'eps2_0.1'
        extra_args: ['-eps2', '0.1']
      - name: 'eps2_0.9'
        extra_args: ['-eps2', '0.9']
  - axis: 'linalg'
    items:
      - name: 'dense-ldlt'
        extra_args: ['--dense-ldlt']
      - name: 'lamg'
        extra_args: ['--lamg']
      - name: 'lu'
        extra_args: ['--lu']
      - name: 'qr'
        extra_args: ['--qr']
  - axis: 'heuristic'
    items:
      - name: 'random'
        extra_args: ['-h0']
      - name: 'ust-diag'
        extra_args: ['-h1']
      - name: 'similarity'
        extra_args: ['-h2']

instdir: "instances"
instances:
  - repo: local
    items: 
      - facebook_ego_combined.nkb
      - arxiv-grqc.nkb
      - arxiv-heph.nkb
      - arxiv-hephth.nkb
      - opsahl-powergrid.nkb
      - erdos_renyi_128_0.1.nkb
      - erdos_renyi_300_0.05.nkb
      - erdos_renyi_600_0.05.nkb
      - watts_strogatz_100_5_0.5.nkb
      - watts_strogatz_300_7_0.5.nkb
      - barabasi_albert_2_100_2.nkb
      - barabasi_albert_2_300_2.nkb
  - repo: local
    items:
      - erdos_renyi_1000_0.02.nkb
      - erdos_renyi_3000_0.01.nkb
      - watts_strogatz_1000_7_0.3.nkb
      - watts_strogatz_3000_7_0.3.nkb
      - barabasi_albert_2_1000_2.nkb
      - barabasi_albert_2_3000_2.nkb
    set: [medium-graphs]



matrix:
  include:
    - experiments: [random-averaged, submodular-greedy]
      instsets: [medium-graphs]
      axes: ['k-size-linear', threads]
    - experiments: [stochastic-greedy, greedy-3]
      instsets: [medium-graphs]
      axes: ['k-size-linear', threads, 'accuracy']
    - experiments: [sq-greedy]
      instsets: [medium-graphs]
      axes: ['k-size-linear', threads, 'accuracy', 'linalg', 'accuracy_trees', 'heuristic']
      variants: ['ust-diag']
    
    # - experiments: [facebook_ego_combined.nkb]


    # - experiments: [random-averaged]
    #   axes: [k-size-linear]
    # - experiments: [submodular-greedy]
    #   axes: [k-size-linear, 'threads']
    # - experiments: [stochastic-greedy]
    #   axes: ['k-size-linear', 'threads', 'accuracy']
    # - experiments: [greedy-3]
    #   axes: ['k-size-linear', 'threads', 'accuracy']
    # - experiments: [sq-greedy]
    #   axes: ['k-size-linear', 'threads', 'accuracy', 'accuracy_trees', 'linalg', 'heuristic']
    #   variants: ['eps_0.9', 'eps2_0.9', '2**-4', '2**-2', '2**0', 'ust-diag']
    # - experiments:  [sq-greedy]
    #   axes: ['k-size-linear', 'threads', 'linalg', 'heuristic', 'accuracy']
    #   variants: ['2**0', 'random', 'similarity', 'eps_0.9', 'eps2_0.9']
